# Shellcode Analysis

__Binary Used__ : _Malware.javaupdate.cs_

![Pasted image 20220919193844](PMAT-Attachments/Pasted%20image%2020220919193844.png)

## Analyzing the source code

![Pasted image 20220919194125](PMAT-Attachments/Pasted%20image%2020220919194125.png)

We can see a bytearray in the variable _rsrc_, which is then written to a newly created space and this is then executed.

Copy the bytes to a text editor.

Now remove all the _0x_ bytes and "_,_" 

![Pasted image 20220919194829](PMAT-Attachments/Pasted%20image%2020220919194829.png)

Now save this file as _carved.bin_

Now we can use _scdbg_ to debug this shellcode.

> scdbg.exe /f carved.bin -s -1

___-s___ : Step count (-1 states unlimited step count)
___/f___ : filename

![Pasted image 20220919195332](PMAT-Attachments/Pasted%20image%2020220919195332.png)

We can see it goes to a server _burn.ec2-13-7-109-121-ubuntu-2004.local_ with https and downloads and writes data from the server into a file called _javaupdate.exe_





