# Advanced Dynamic Analysis 

## Introduction

Here, we will be debugging malware and understanding the execution flow of the malware when run. This would also give us the freedom to control the said execution flow and manipulate it to our convenience.

Types of tools used :
- Debuggers

## Debugging a malware sample

__Binary used__ : _Dropper.DownloadFromURL.exe.malz_

![Pasted image 20220913165438](PMAT-Attachments/Pasted%20image%2020220913165438.png)

> Program used : _x32dbg_

Load the malware sample onto the debugger.

![Pasted image 20220914211040](PMAT-Attachments/Pasted%20image%2020220914211040.png)

![Pasted image 20220914211642](PMAT-Attachments/Pasted%20image%2020220914211642.png)

We can see the debuggers loads us onto the first instruction which is executed when the program is run. It breaks at entrypoint.

Options :

![Pasted image 20220914211204](PMAT-Attachments/Pasted%20image%2020220914211204.png)

![Pasted image 20220914211532](PMAT-Attachments/Pasted%20image%2020220914211532.png)

At the above statement we observe the program takes a bit of time, let us set a breakpoint and restart the program.

Once we hit a breakpoint, we can step into the function.

![Pasted image 20220914211739](PMAT-Attachments/Pasted%20image%2020220914211739.png)

We can observe multiple Windows API calls being made.

![Pasted image 20220914212550](PMAT-Attachments/Pasted%20image%2020220914212550.png)

![Pasted image 20220914213046](PMAT-Attachments/Pasted%20image%2020220914213046.png)


We can continue our analysis step by step and go through the flow of execution.
