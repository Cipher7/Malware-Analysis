# Basic Dynamic Analysis - Part I

__Binary Used__  :  _Malware.Unknown.exe_

> Arm the malware sample by removing the .malz extension.

There are two types of indicators which we will be looking for -
- Network Indicators
- Host based Indicators

## Network Indicators

From our initial static analysis, we found out that the application was making some network calls to different domains.

![Pasted image 20220907132213](Attachments/Pasted%20image%2020220907132213.png)

Start the application in the Flare VM and look for any network calls in our Remnux VM with the help of wireshark.

![Pasted image 20220908221320](Attachments/Pasted%20image%2020220908221320.png)

We see the full URL to which the GET request is sent. This can be used as a network signature for this malware sample.

Another GET request 

![Pasted image 20220908221800](Attachments/Pasted%20image%2020220908221800.png)



## Host based Indicators

For Host based indicators, we will be using procmon

Apply filters to filter out this process 

![Pasted image 20220908223217](Attachments/Pasted%20image%2020220908223217.png)

We can see that it creates a file successfully in the Documents folder of teh public user.
Also we can observe that the file icon is the favicon image of inetsim.

This would mean that the program fetches the favicon image and then downloads it and converts it into an executable, like a second stage.

Now kill inetsim and filter our the _cmd.exe /C ping 1.1.1.1 -n 1_ command from the static analysis screenshot as a _detail_ which contains the string.

![Pasted image 20220908224437](Attachments/Pasted%20image%2020220908224437.png)

Now run the malware again.

![Pasted image 20220908224640](Attachments/Pasted%20image%2020220908224640.png)

Here we can see the full command being run when the malware cannot ping the server.


Final Process of Malware :-
- If the URL exists and the server is reachable
	- Download the favicon.ico file
	- Store it as an exe
	- Run the file
- If the URL does not exist
	- File deletes itself
	- Self-destruction occurs









