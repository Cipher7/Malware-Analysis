# Basic Static Analysis

> __Binary Used__  :  _Malware.Unknown.exe_

## Hashing the samples

![Pasted image 20220907131239](PMAT-Attachments/Pasted%20image%2020220907131239.png)

Use cmder to get the md5sum and sha256 hashes of the sample

| Hash Algorithm |                               Hash                               |
|:--------------:|:----------------------------------------------------------------:|
|     md5sum     |                 1d8562c0adcaee734d63f7baaca02f7c                 |
|     sha256     | 92730427321a1c4ccfc0d0580834daef98121efa9bb8963da332bfd6cf1fda8a |


## Virustotal

![Pasted image 20220907131954](PMAT-Attachments/Pasted%20image%2020220907131954.png)


## strings

![Pasted image 20220907132154](PMAT-Attachments/Pasted%20image%2020220907132154.png)

![Pasted image 20220907132213](PMAT-Attachments/Pasted%20image%2020220907132213.png)


## PEview

![Pasted image 20220907133940](PMAT-Attachments/Pasted%20image%2020220907133940.png)

The MZ magic byte confirms that the file is an executable file.

---
> **Fun Fact** 
>
>MZ is actually the initials of Mark Zbikowski, one of the leading developers of MS-DOS
>
---
#### Date-Timestamp

![Pasted image 20220907134658](PMAT-Attachments/Pasted%20image%2020220907134658.png)

#### Packed or Unpacked?

![Pasted image 20220907134559](PMAT-Attachments/Pasted%20image%2020220907134559.png)


The virtual size is the amount of data on disk when the binary is run. If the size of Virtual Data is way more than the size of the raw data, then it is a packed data.

#### Import Address Table

This gives us a list of [Windows APIs](https://microsoft.fandom.com/wiki/Windows_API) being called during the execution of the binary.

![Pasted image 20220907135026](PMAT-Attachments/Pasted%20image%2020220907135026.png)

[Malapi.io](https://malapi.io/) can be used to find out malicious Windows APIs and their documentation.


#### Key differences between a packed and an Unpacked Binary

1. The Virtual Size and Raw data size will have a huge difference in a packed binary.
2. The _IMPORT Address Table_ will have a lot of APIs which can be clearly viewed in an unpacked binary, unlike the packed binary.
3. Some key components of a packer program, eg UPX, can be seen in PEview.


## PEStudio

Helps in speeding up static analysis.

![Pasted image 20220907142443](PMAT-Attachments/Pasted%20image%2020220907142443.png)

It also identifies some malicious identifiers from the binary and also grades them in different levels.

![Pasted image 20220907142553](PMAT-Attachments/Pasted%20image%2020220907142553.png)

Malicious libraries used by the binary.

![Pasted image 20220907142643](PMAT-Attachments/Pasted%20image%2020220907142643.png)


Strings in the binary

![Pasted image 20220907142711](PMAT-Attachments/Pasted%20image%2020220907142711.png)

