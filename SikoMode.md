__Binary Used__ : _unknown.exe.malz_

# Challenge

![[Attachments/Pasted image 20220915214048.png]]

# Static Analysis

## Hashes

| Hash Algorithm |                               Hash                               |
|:--------------:|:----------------------------------------------------------------:|
|      MD5       |                 b9497ffb7e9c6f49823b95851ec874e3                 |
|     SHA256     | 3aca2a08cf296f1845d6171958ef0ffd1c8bdfc3e48bdd34a605cb1f7468213e |
|                |                                                                  |


## Virustotal

![[Attachments/Pasted image 20220915214510.png]]


## Floss

![[Attachments/Pasted image 20220915214729.png]]

![[Attachments/Pasted image 20220915214820.png]]

Windows APIs detected

![[Attachments/Pasted image 20220915215015.png]]


## PEstudio

![[Attachments/Pasted image 20220915215756.png]]

![[Attachments/Pasted image 20220915220702.png]]

Large Overlay size?

![[Attachments/Pasted image 20220915220725.png]]


##  Cutter

Initial check if URL is accessible

![[Attachments/Pasted image 20220915222513.png]]

![[Attachments/Pasted image 20220915222547.png]]

![[Attachments/Pasted image 20220915222808.png]]

![[Attachments/Pasted image 20220915224247.png]]


___ENCRYPTION USED___ : __RC4__


# Dynamic Analysis

### Running binary without inetsim

- Binary Deletes itself

### Running binary with inetsim

- Some kind of background operation takes place. We can assume that the binary first tries to connect to a domain/IP and if not successful, then self destructs.


## Network Indicators

### Wireshark

![[Attachments/Pasted image 20220915223301.png]]

Starts doing GET requests with encrypted data

![[Attachments/Pasted image 20220915223352.png]]

This means that the binary is sending in data to the remote webserver. DNS Exfiltration


## Host Indicators

### Procmon

 **_Procmon Filter_**
> - Process name contains _unknown_

![[Attachments/Pasted image 20220915223628.png]]

![[Attachments/Pasted image 20220915223933.png]]

![[Attachments/Pasted image 20220915223955.png]]




Final Process of the malware -
- Tries to connect to a remote server
	- If successful,
		- Exfiltrates encrypted data
	- Else,
		- Deletes itself
